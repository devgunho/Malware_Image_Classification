import os
import hashlib

original_dataset_dir = './datasets/base'
# original_dataset_dir = './modified_datasets/base'

normal_list = []
new_normal_list = []
normal_hash_list = []
encryption_list = []

for dirpath, dirnames, filenames in os.walk(original_dataset_dir):
    for filename in filenames:
        if "Normal" in filename:
            normal_list.append(filename)
        if "Encryption" in filename:
            encryption_list.append(filename)

print("[*] Unclassified Normal Total :", len(normal_list))
print("[*] Unclassified Encryption Total :", len(encryption_list))

file_cnt = 1
for nor_filename in normal_list:
    new_nor_filename = nor_filename.replace('Normal', '')
    new_normal_list.append(new_nor_filename)
    f = open(original_dataset_dir+'/'+nor_filename, 'rb')
    data = f.read()
    print("%05d SHA-256 : %s" % (file_cnt, hashlib.sha256(data).hexdigest()))
    file_cnt += 1

# for enc_filename in encryption_list:
#     new_enc_filename=enc_filename.replace('Encryption','')
#     for nor_filename in normal_list:
#         new_nor_filename=nor_filename.replace('Normal','')
#         if new_nor_filename == new_enc_filename:
#             only_encryption.remove(enc_filename)

# print(len(only_normal))
# print(len(only_encryption))
